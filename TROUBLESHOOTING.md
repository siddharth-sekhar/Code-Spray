# Troubleshooting 400 Bad Request Error on Render

## Common Causes and Solutions

### 1. Environment Variables
Make sure these environment variables are set in your Render dashboard:

```
DEBUG=False
SECRET_KEY=<auto-generated-by-render>
ALLOWED_HOSTS=.onrender.com,your-app-name.onrender.com
DATABASE_URL=<provided-by-render>
```

### 2. Database Issues
- Check if the database is properly provisioned
- Verify DATABASE_URL is correct
- Check Render logs for database connection errors

### 3. Static Files
- Ensure build.sh has execute permissions
- Check if static files are being collected properly
- Verify STATIC_ROOT and STATIC_URL settings

### 4. Custom Middleware
- The PreventBackButtonMiddleware has been temporarily commented out
- Check if this was causing the issue

### 5. Debugging Steps

#### Step 1: Check Health Endpoint
Try accessing: `https://your-app.onrender.com/health/`
This should return "OK" if the basic Django setup is working.

#### Step 2: Check Root Endpoint
Try accessing: `https://your-app.onrender.com/`
This should return "Online Judge Project is running!" if the basic setup is working.

#### Step 3: Check Render Logs
Look at the build and runtime logs in your Render dashboard for specific error messages.

#### Step 4: Database Migration
Ensure the build script is running migrations:
```bash
python manage.py migrate
```

### 6. Common Fixes

#### Fix 1: Update Requirements
Make sure all dependencies are in requirements.txt:
```
google.generativeai
django
gunicorn
whitenoise
psycopg2-binary
python-decouple
dj-database-url
```

#### Fix 2: Check Build Script
Ensure build.sh has execute permissions and contains:
```bash
#!/usr/bin/env bash
set -o errexit
pip install -r requirements.txt
python manage.py collectstatic --no-input
python manage.py migrate
```

#### Fix 3: Environment Variables
Set these in Render dashboard:
- DEBUG: False
- SECRET_KEY: (auto-generated)
- ALLOWED_HOSTS: .onrender.com,your-app-name.onrender.com

### 7. Testing Locally
Test your changes locally before deploying:
```bash
python manage.py collectstatic
python manage.py migrate
python manage.py runserver
```

### 8. Render-Specific Issues
- Free tier has limitations
- Database provisioning might take time
- Static file serving might be slow initially
